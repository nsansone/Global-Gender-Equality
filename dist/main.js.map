{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/globe.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","buildChart","data","margin","width","height","x","d3","scale","ordinal","rangeRoundBands","y","linear","range","xAxis","max","svg","axis","orient","yAxis","ticks","chart","select","attr","append","domain","map","style","selectAll","enter","rangeBand","sens","percentColors","pct","color","g","b","getColorForPercentage","length","lower","upper","rangePct","pctLower","pctUpper","Math","floor","join","projection","geo","orthographic","rotate","translate","clipAngle","path","datum","type","countryTooltip","countryList","queue","defer","json","tsv","await","error","world","countryData","percentData","detailData","noDataCountries","countryPercents","percentById","countryById","countryDetails","countries","topojson","feature","objects","features","forEach","id","option","text","percent","parseFloat","arr","push","a","e","config","speed","verticalTilt","horizontalTilt","stopRotation","lastElapsed","timerGlobeRotation","elapsed","stopGlobe","timer","each","this","console","log","behavior","drag","origin","on","event","classed","includes","showContentCont","remove","alpha","val","idx","pageX","pageY","focusedCountry","cnt","sel","country","centroid","transition","duration","tween","interpolate"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","\n\nfunction type(d) {\n  d.value = +d.value; // coerce to number\n  return d;\n}\nfunction buildChart(data) {\n  var margin = { top: 20, right: 30, bottom: 30, left: 40 },\n    width = 400 - margin.left - margin.right,\n    height = 220 - margin.top - margin.bottom;\n\n  var x = d3.scale.ordinal().rangeRoundBands([0, width], 0.1);\n\n  var y = d3.scale.linear().range([height, 0]);\n\n  var heightRatio = d3.max(data) / height\n\n  var xAxis = d3.svg\n    .axis()\n    .scale(x)\n    .orient(\"bottom\");\n\n  var yAxis = d3.svg\n    .axis()\n    .scale(y)\n    .orient(\"left\")\n    .ticks(10, \"%\");\n\n  var chart = d3\n    .select(\".chart\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom)\n    .append(\"g\")\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    x.domain(\n      data.map(function(d) {\n        return d.name;\n      })\n    );\n    y.domain([\n      0,\n      d3.max(data, function(d) {\n        return d.value;\n      })\n    ]);\n\n    chart\n      .append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(xAxis);\n\n    chart\n      .append(\"g\")\n      .attr(\"class\", \"y axis\")\n      .call(yAxis)\n      .append(\"text\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", 100)\n      .attr(\"dy\", \".71em\")\n      .style(\"text-anchor\", \"end\")\n      // .text(\"Frequency\");\n\n    chart\n      .selectAll(\".bar\")\n      .data(data)\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"bar\")\n      .attr(\"x\", function(d) {\n        return x(d.name);\n      })\n      .attr(\"y\", function(d) {\n        return y(d.value);\n      })\n      .attr(\"height\", function(d) {\n        return height - y(d.value);\n      })\n      .attr(\"width\", x.rangeBand());\n      \n}\n\n//bar chart help from https://bost.ocks.org/mike/bar/2/\nvar width = 800,\n  height = 750,\n  sens = 0.2,\n  focused;\n\nvar percentColors = [\n  { pct: 0.0, color: { r: 169, g: 169, b: 169 } },\n  { pct: 0.5, color: { r: 128, g: 128, b: 128 } },\n  { pct: 1.0, color: { r: 0, g: 0, b: 0 } }\n];\n\nvar getColorForPercentage = function(pct) {\n  for (var i = 1; i < percentColors.length - 1; i++) {\n    if (pct === \"-\") {\n      return \"white\";\n    }\n    if (pct < percentColors[i].pct) {\n      break;\n    }\n  }\n  var lower = percentColors[i - 1];\n  var upper = percentColors[i];\n  var range = upper.pct - lower.pct;\n  var rangePct = (pct - lower.pct) / range;\n  var pctLower = 1 - rangePct;\n  var pctUpper = rangePct;\n  var color = {\n    r: Math.floor(lower.color.r * pctLower + upper.color.r * pctUpper),\n    g: Math.floor(lower.color.g * pctLower + upper.color.g * pctUpper),\n    b: Math.floor(lower.color.b * pctLower + upper.color.b * pctUpper)\n  };\n  return \"rgb(\" + [color.r, color.g, color.b].join(\",\") + \")\";\n  // or output as hex if preferred\n};\n\n//https://stackoverflow.com/questions/7128675/from-green-to-red-color-depend-on-percentage\n// color picking code taken from above link\nconst clickColor = getColorForPercentage(0.1);\n//Setting projection\n\nvar projection = d3.geo\n  .orthographic()\n  .scale(350)\n  .rotate([0, 0])\n  .translate([width / 2, height / 2])\n  .clipAngle(90);\n\nvar path = d3.geo.path().projection(projection);\n\n//SVG container\n\nvar svg = d3\n  .select(\".globe\")\n  // .append(\"svg\")\n  // .attr(\"width\", width)\n  // .attr(\"height\", height)\n\n//Adding water\n\nsvg\n  .append(\"path\")\n  .datum({ type: \"Sphere\" })\n  .attr(\"class\", \"water\")\n  // .style(\"fill\", \"whitesmoke\")\n  .attr(\"d\", path);\n\nvar countryTooltip = d3\n    .select(\".globe\")\n    .append(\"div\")\n    .attr(\"class\", \"countryTooltip\"),\n  countryList = d3\n    .select(\".select\")\n    // .append(\"select\")\n    // .attr(\"name\", \"countries\");\n\nqueue()\n  .defer(d3.json, \"src/data/world-110m.json\")\n  .defer(d3.tsv, \"src/data/world-110m-country-names.tsv\")\n  .defer(d3.tsv, \"src/data/aggregate-scores.tsv\")\n  .defer(d3.tsv, \"src/data/detail-scores.tsv\")\n  .await(ready);\n\n//Main function\n\nfunction ready(error, world, countryData, percentData, detailData) {\n  const noDataCountries = [\"Afghanistan\", \"Antartica\", \"Bahamas\", \"Brunei Darussalam\",\"Burundi\",\n                          \"Central African Republic\", \"Cuba\",\"Cyprus\",\"Djibouti\",\"Equatorial Guinea\",\n                          \"Eritrea\",\"Falkland Islands (Malvinas)\",\"Fiji\",\"French Southern Territories\",\n                          \"Gabon\",\"Gambia\",\"Greenland\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Iceland\",\n                          \"Iran, Islamic Republic of\",\"Korea, Democratic People's Republic of\",\"Kuwait\",\n                          \"Libya\",\"Luxembourg\",\"New Caledonia\",\"Oman\",\"Palestinian Territory, Occupied\",\n                          \"Papua New Guinea\",\"Puerto Rico\",\"Qatar\",\"Solomon Islands\",\"Somalia\",\"South Sudan\",\n                          \"Sudan\",\"Suriname\",\"Swaziland\",\"Syrian Arab Republic\",\"Taiwan, Province of China\",\n                          \"Timor-Leste\",\"Turkmenistan\",\"United Arab Emirates\",\"Uzbekistan\",\"Vanatu\",\"Western Sahara\"];\n  var countryPercents = {};\n  var percentById = {};\n  var countryById = {};\n  var countryDetails = {};\n    var countries = topojson.feature(world, world.objects.countries).features;\n\n  //Adding countries to select\n\n  countryData.forEach(function(d) {\n    countryById[d.id] = d.name;\n    option = countryList.append(\"option\");\n    option.text(d.name);\n    option.property(\"value\", d.id);\n\n    percentData.forEach(function(d) {\n      if (d.percent === \"-\") {\n        countryPercents[d.name] = \"-\";\n      } else {\n        countryPercents[d.name] = parseFloat(d.percent) / 100;\n      }\n    });\n\n    countryData.forEach(function(d) {\n      percentById[d.id] = countryPercents[d.name];\n    });\n\n    detailData.forEach(function(d) {\n      let arr = [];\n      arr.push(d.a)\n      arr.push(d.b)\n      arr.push(d.c)\n      arr.push(d.d)\n      arr.push(d.e)\n      countryDetails[d.name] = arr;\n    })\n\n  \n  });\n\n  let config = {\n    speed: 0.005,\n    verticalTilt: -10,\n    horizontalTilt: 0\n  };\n\n\n  \n  let stopRotation = false;\n  let lastElapsed = 0\n\n  const timerGlobeRotation = (elapsed) => {\n   \n    projection.rotate([\n      config.speed * (lastElapsed + elapsed) - 120,\n      config.verticalTilt,\n      config.horizontalTilt\n    ]);\n    svg.selectAll(\"path\").attr(\"d\", path);\n    if (stopRotation) {\n      lastElapsed += elapsed\n    }\n    return stopRotation\n  }\n  \n  function enableRotation() {\n    d3.timer(timerGlobeRotation)\n  }\n  function stopGlobe() {\n    stopRotation = true\n    // if (!stopRotation) {\n    //   enableRotation();\n    // }\n  }\n  \n  enableRotation();\n\n  // setTimeout(stopGlobe, 3000)\n\n\n  //Drawing countries on the globe\n  \n  var world = svg\n    .selectAll(\"path.land\")\n    .data(countries)\n    .enter()\n    .append(\"path\")\n    .attr(\"class\", \"land\")\n    .attr(\"d\", path)\n\n    // .style(\"fill\", )\n\n    .each(function(d, i) {\n      // console.log(d)\n      if (percentById[d.id] === \"-\" || d.id === -99) {\n        d3.select(this).style(\"fill\", \"white\");\n        console.log(\"setting color white\");\n      } else {\n        d3.select(this).style(\n          \"fill\",\n          getColorForPercentage(percentById[d.id])\n        );\n      }\n    })\n    //Drag event\n\n    .call(\n      d3.behavior\n        .drag()\n        .origin(function() {\n          var r = projection.rotate();\n          return { x: r[0] / sens, y: -r[1] / sens };\n        })\n        .on(\"dragstart\", function() {\n          stopGlobe();\n        })\n        .on(\"drag\", function() {\n          var rotate = projection.rotate();\n          projection.rotate([\n            d3.event.x * sens,\n            -d3.event.y * sens,\n            rotate[2]\n          ]);\n          svg.selectAll(\"path\").attr(\"d\", path);\n          // svg.selectAll(\".water\").attr(\"d\", path)\n          svg.selectAll(\".focused\").classed(\"focused\", (focused = false));\n\n          // lastElapsed += d3.event.x * sens\n          config.verticalTilt = -d3.event.y * sens;\n          config.horizontalTilt = rotate[2];\n        })\n        .on(\"dragend\", function() {\n          stopGlobe();\n        })\n    )\n\n    //Mouse events\n\n    .on(\"click\", function(d) {\n        svg.selectAll(\".focused\").classed(\"focused\", (focused = false));\n        d3.select(this).attr(\"class\", \"focused\");\n        let name = countryById[d.id];\n        if (noDataCountries.includes(name)) {\n          const showContentCont = d3.select(\"div.show-content-cont\");\n          showContentCont.selectAll(\"*\").remove();\n           showContentCont\n             .append(\"h1\")\n             .text(countryById[d.id])\n             .append(\"p\")\n             .attr(\"class\", \"no-data\")\n             .text(\"Data has not been collected for this country in this study\");\n        } else {\n        let arr = [];\n        let alpha = [\"A\", \"B\", \"C\", \"D\", \"E\"]\n        countryDetails[name].forEach((val, idx) => {\n          if (val === \"-\") {\n            arr.push({name: \"data not present\", value: 0});\n          } else {\n            arr.push({name: alpha[idx], value: parseFloat(val)/100});\n          }\n        });\n        const showContentCont = d3.select(\"div.show-content-cont\");\n        showContentCont\n          .selectAll(\"*\")\n          .remove()\n        showContentCont\n          .append(\"h1\")\n          .text(countryById[d.id])\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"The Five Metrics:\")\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"A: Proportion of women aged 20-24 years who were married or in a union before age 18\")\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"B: Percentage of women (aged 15+ years) who agree that a husband is justified in beating his wife/partner under certain circumstances\")\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"C: The extend to which there are legal grounds for abortion\")\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"D: Proportion of seats held by women in national parliaments\")\n          .append(\"p\")\n          .attr(\"class\", \"show-content-p\")\n          .text(\"E: Proportion of ministerial/senior government positions held by women\");\n        showContentCont\n          .append(\"svg\")\n          .attr(\"class\", \"chart\")\n        buildChart(arr);\n    }})\n  \n\n    .on(\"mouseover\", function(d) {\n      countryTooltip\n        .text(countryById[d.id])\n        .style(\"left\", d3.event.pageX + 7 + \"px\")\n        .style(\"top\", d3.event.pageY - 15 + \"px\")\n        .style(\"display\", \"block\")\n        .style(\"opacity\", 1);\n    })\n    .on(\"mouseout\", function(d) {\n      countryTooltip.style(\"opacity\", 0).style(\"display\", \"none\");\n    })\n    .on(\"mousemove\", function(d) {\n      countryTooltip\n        .style(\"left\", d3.event.pageX + 7 + \"px\")\n        .style(\"top\", d3.event.pageY - 15 + \"px\");\n    });\n\n  //Country focus on option select\n\n  d3.select(\"select\").on(\"change\", function() { \n    var rotate = projection.rotate(),\n    focusedCountry = country(countries, this),\n    p = d3.geo.centroid(focusedCountry);\n\n    let name = countryById[focusedCountry.id];\n    if (noDataCountries.includes(name)) {\n          const showContentCont = d3.select(\"div.show-content-cont\");\n          showContentCont.selectAll(\"*\").remove();\n           showContentCont\n             .append(\"h1\")\n             .text(countryById[focusedCountry.id])\n             .append(\"p\")\n             .attr(\"class\", \"no-data\")\n             .text(\"Data has not been collected for this country in this study\");\n        } else {\n    let arr = [];\n    let alpha = [\"A\", \"B\", \"C\", \"D\", \"E\"];\n    countryDetails[name].forEach((val, idx) => {\n      if (val === \"-\") {\n        arr.push({ name: \"data not present\", value: 0 });\n      } else {\n        arr.push({ name: alpha[idx], value: parseFloat(val) / 100 });\n      }\n    });\n    const showContentCont = d3.select(\"div.show-content-cont\");\n    showContentCont.selectAll(\"*\").remove();\n    showContentCont\n      .append(\"h1\")\n      .text(countryById[focusedCountry.id])\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\"The Five Metrics:\")\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\n        \"A: Proportion of women aged 20-24 years who were married or in a union before age 18\"\n      )\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\n        \"B: Percentage of women (aged 15+ years) who agree that a husband is justified in beating his wife/partner under certain circumstances\"\n      )\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\"C: The extend to which there are legal grounds for abortion\")\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\"D: Proportion of seats held by women in national parliaments\")\n      .append(\"p\")\n      .attr(\"class\", \"show-content-p\")\n      .text(\n        \"E: Proportion of ministerial/senior government positions held by women\"\n      );\n      showContentCont.append(\"svg\").attr(\"class\", \"chart\");\n      buildChart(arr);\n    }\n    svg.selectAll(\".focused\").classed(\"focused\", (focused = false));\n\n    //Globe rotating\n\n    (function transition() {\n      d3.transition()\n        .duration(2500)\n        .tween(\"rotate\", function() {\n          var r = d3.interpolate(projection.rotate(), [-p[0], -p[1]]);\n          return function(t) {\n            projection.rotate(r(t));\n            svg\n              .selectAll(\"path\")\n              .attr(\"d\", path)\n              .classed(\"focused\", function(d, i) {\n                return d.id == focusedCountry.id ? (focused = d) : false;\n              });\n          };\n        })\n        stopGlobe();\n        \n    })();\n  });\n\n  function country(cnt, sel) {\n    for (var i = 0, l = cnt.length; i < l; i++) {\n      if (cnt[i].id == sel.value) {\n        return cnt[i];\n      }\n    }\n  }\n}\n\n"],"sourceRoot":""}