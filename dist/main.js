!function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/dist/",a(a.s=1)}([function(t,e){function a(t){var e=20,a=30,n=30,o=40,r=400-o-a,s=220-e-n,i=d3.scale.ordinal().rangeRoundBands([0,r],.1),l=d3.scale.linear().range([s,0]),c=d3.svg.axis().scale(i).orient("bottom"),p=d3.svg.axis().scale(l).orient("left").ticks(10,"%"),d=d3.select(".chart").attr("width",r+o+a).attr("height",s+e+n).append("g").attr("transform","translate("+o+","+e+")");i.domain(t.map(function(t){return t.name})),l.domain([0,1]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(c),d.append("g").attr("class","y axis").call(p).append("text").attr("transform","rotate(-90)").attr("y",100).attr("dy",".71em").style("text-anchor","end"),d.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",function(t){return i(t.name)}).attr("width",i.rangeBand()).transition().delay(function(t,e){return 100*e}).attr("y",function(t){return l(t.value)}).attr("height",function(t){return s-l(t.value)})}var n=.2,o=[{pct:0,color:{r:255,g:255,b:255}},{pct:.5,color:{r:204,g:199,b:169}},{pct:1,color:{r:86,g:79,b:65}}],r=function(t){for(var e=1;e<o.length-1;e++){if("-"===t)return"white";if(t<o[e].pct)break}var a=o[e-1],n=o[e],r=n.pct-a.pct,s=(t-a.pct)/r,i=1-s,l=s,c={r:Math.floor(a.color.r*i+n.color.r*l),g:Math.floor(a.color.g*i+n.color.g*l),b:Math.floor(a.color.b*i+n.color.b*l)};return"rgb("+[c.r,c.g,c.b].join(",")+")"},s=(r(.1),d3.geo.orthographic().scale(350).rotate([0,0]).translate([400,375]).clipAngle(90)),i=d3.geo.path().projection(s),l=d3.select(".globe");l.append("path").datum({type:"Sphere"}).attr("class","water").attr("d",i);var c=d3.select(".globe").append("div").attr("class","countryTooltip"),p=d3.select(".select");queue().defer(d3.json,"src/data/world-110m.json").defer(d3.tsv,"src/data/world-110m-country-names.tsv").defer(d3.tsv,"src/data/aggregate-scores.tsv").defer(d3.tsv,"src/data/detail-scores.tsv").await(function(t,e,o,d,u){var h=["Afghanistan","Antarctica","Bahamas","Brunei Darussalam","Burundi","Central African Republic","Cuba","Cyprus","Djibouti","Equatorial Guinea","Eritrea","Falkland Islands (Malvinas)","Fiji","French Southern Territories","Gabon","Gambia","Greenland","Guinea","Guinea-Bissau","Guyana","Haiti","Iceland","Islamic Republic of Iran","Democratic People's Republic of Korea","Kuwait","Libya","Luxembourg","New Caledonia","Oman","Palestinian Territory, Occupied","Papua New Guinea","Puerto Rico","Qatar","Solomon Islands","Somalia","South Sudan","Sudan","Suriname","Swaziland","Syrian Arab Republic","Taiwan, Province of China","Timor-Leste","Turkmenistan","United Arab Emirates","Uzbekistan","Vanatu","Western Sahara"],f={},g={},m={},v={},y=topojson.feature(e,e.objects.countries).features;option=p.append("option"),option.text("--select a country--"),option.property("disabled","true"),option.property("selected","true"),o.forEach(function(t){m[t.id]=t.name,option=p.append("option"),option.text(t.name),option.property("value",t.id),d.forEach(function(t){"-"===t.percent?f[t.name]="-":f[t.name]=parseFloat(t.percent)/100}),o.forEach(function(t){g[t.id]=f[t.name]}),u.forEach(function(t){var e=[];e.push(t.a),e.push(t.b),e.push(t.c),e.push(t.d),e.push(t.e),v[t.name]=e})});var b={speed:.005,verticalTilt:-10,horizontalTilt:0},w=!1,x=0,A=function(t){return s.rotate([b.speed*(x+t)-120,b.verticalTilt,b.horizontalTilt]),l.selectAll("path").attr("d",i),w&&(x+=t),w};function T(){w=!0}d3.timer(A);e=l.selectAll("path.land").data(y).enter().append("path").attr("class","land").attr("d",i).each(function(t,e){"-"===g[t.id]||-99===t.id?(d3.select(this).style("fill","white"),console.log("setting color white")):d3.select(this).style("fill",r(g[t.id]))}).call(d3.behavior.drag().origin(function(){var t=s.rotate();return{x:t[0]/n,y:-t[1]/n}}).on("dragstart",function(){T()}).on("drag",function(){var t=s.rotate();s.rotate([d3.event.x*n,-d3.event.y*n,t[2]]),l.selectAll("path").attr("d",i),l.selectAll(".focused").classed("focused",!1),b.verticalTilt=-d3.event.y*n,b.horizontalTilt=t[2]}).on("dragend",function(){T()})).on("click",function(t){d3.select("option").text(m[t.id]).property("selected","true");s.rotate();var e=d3.geo.centroid(t),n=m[t.id];if(h.includes(n)){var o=d3.select("div.show-content-cont");o.selectAll("*").remove(),o.append("h1").text(m[t.id]).append("p").attr("class","no-data").text("Data has not been collected for this country in this study")}else{var r,c=[],p=["A","B","C","D","E"];v[n].forEach(function(t,e){"-"===t?c.push({name:"data not present",value:0}):c.push({name:p[e],value:parseFloat(t)/100})}),r="-"===g[t.id]?"-":Math.round(1e4*g[t.id])/100;var d=d3.select("div.show-content-cont");d.selectAll("*").remove(),d.append("h1").attr("class","show-content-title").text(m[t.id]).append("p").attr("class","show-content-total").html('<span class="highlight">The Five Metrics:</span>').append("p").attr("class","show-content-p").html('A: Proportion of women aged 20-24 years who were <span class="highlight">married or in a union before age 18</span>').append("p").attr("class","show-content-p").html('B: Percentage of women (aged 15+ years) who agree that a <span class="highlight">husband is justified in beating his wife</span>/partner under certain circumstances').append("p").attr("class","show-content-p").html('C: The extent to which there are <span class="highlight">legal grounds for abortion</span>').append("p").attr("class","show-content-p").html('D: Proportion of <span class="highlight">seats held by women</span> in national parliaments').append("p").attr("class","show-content-p").html('E: Proportion of ministerial/<span class="highlight">senior government positions</span> held by women').append("p").attr("class","show-content-p").append("p").attr("class","show-content-total").html('<span class="highlight">Total Score: '.concat(r,'<span class="percent" > %</span></span>')),d.append("svg").attr("class","chart"),a(c)}l.selectAll(".focused").classed("focused",!1),d3.transition().duration(2500).tween("rotate",function(){var a=d3.interpolate(s.rotate(),[-e[0],-e[1]]);return function(e){s.rotate(a(e)),l.selectAll("path").attr("d",i).classed("focused",function(e,a){return e.id==t.id&&e})}}),T()}).on("mouseover",function(t){c.text(m[t.id]).style("left",d3.event.pageX+7+"px").style("top",d3.event.pageY-15+"px").style("display","block").style("opacity",1)}).on("mouseout",function(t){c.style("opacity",0).style("display","none")}).on("mousemove",function(t){c.style("left",d3.event.pageX+7+"px").style("top",d3.event.pageY-15+"px")});d3.select("select").on("change",function(){s.rotate();var t=function(t,e){for(var a=0,n=t.length;a<n;a++)if(t[a].id==e.value)return t[a]}(y,this),e=d3.geo.centroid(t),n=m[t.id];if(h.includes(n)){var o=d3.select("div.show-content-cont");o.selectAll("*").remove(),o.append("h1").text(m[t.id]).append("p").attr("class","no-data").text("Data has not been collected for this country in this study")}else{var r;r="-"===g[t.id]?"-":Math.round(1e4*g[t.id])/100;var c=[],p=["A","B","C","D","E"];v[n].forEach(function(t,e){"-"===t?c.push({name:"data not present",value:0}):c.push({name:p[e],value:parseFloat(t)/100})});var d=d3.select("div.show-content-cont");d.selectAll("*").remove(),d.append("h1").attr("class","show-content-title").text(m[t.id]).append("p").attr("class","show-content-total").html('<span class="highlight">The Five Metrics:</span>').append("p").attr("class","show-content-p").html('A: Proportion of women aged 20-24 years who were <span class="highlight">married or in a union before age 18</span>').append("p").attr("class","show-content-p").html('B: Percentage of women (aged 15+ years) who agree that a <span class="highlight">husband is justified in beating his wife</span>/partner under certain circumstances').append("p").attr("class","show-content-p").html('C: The extent to which there are <span class="highlight">legal grounds for abortion</span>').append("p").attr("class","show-content-p").html('D: Proportion of <span class="highlight">seats held by women</span> in national parliaments').append("p").attr("class","show-content-p").html('E: Proportion of ministerial/<span class="highlight">senior government positions</span> held by women').append("p").attr("class","show-content-p").append("p").attr("class","show-content-total").html('<span class="highlight">Total Score: '.concat(r,'<span class="percent" > %</span></span>')),d.append("svg").attr("class","chart"),a(c)}l.selectAll(".focused").classed("focused",!1),d3.transition().duration(2500).tween("rotate",function(){var a=d3.interpolate(s.rotate(),[-e[0],-e[1]]);return function(e){s.rotate(a(e)),l.selectAll("path").attr("d",i).classed("focused",function(e,a){return e.id==t.id&&e})}}),T()})})},function(t,e,a){"use strict";a.r(e);a(0)}]);
//# sourceMappingURL=main.js.map